#include<stdio.h>
#include<string.h>
#include<ctype.h>

char prod[10][10];
char trailing[10][10];
int n;

int isNonTerminal(char c)
{
    return (c >= 'A' && c <= 'Z');
}

void addTrailing(int i, char c)
{
    int k;
    for(k = 0; trailing[i][k] != '\0'; k++)
        if(trailing[i][k] == c)
            return;

    trailing[i][k] = c;
    trailing[i][k+1] = '\0';
}

void findTrailing(int i)
{
    int j;
    int len = strlen(prod[i]);

    // last symbol of RHS (example E=E+T â†’ T)
    char last = prod[i][len-1];

    if(!isNonTerminal(last))
    {
        addTrailing(i, last);
        return;
    }

    for(j = 0; j < n; j++)
    {
        if(prod[j][0] == last)
        {
            findTrailing(j);
            strcat(trailing[i], trailing[j]);
        }
    }
}

int main()
{
    int i;

    printf("Enter number of productions: ");
    scanf("%d", &n);

    printf("Enter productions (example E=E+T):\n");
    for(i = 0; i < n; i++)
        scanf("%s", prod[i]);

    for(i = 0; i < n; i++)
        trailing[i][0] = '\0';

    for(i = 0; i < n; i++)
        findTrailing(i);

    printf("\nTRAILING sets:\n");
    for(i = 0; i < n; i++)
        printf("TRAILING(%c) = { %s }\n", prod[i][0], trailing[i]);

    return 0;
}
